<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALU Test Suite - Datorteknik</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #00ff00;
        }
        h1 {
            color: #00ff00;
            text-align: center;
        }
        #console {
            background: #000;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #333;
            min-height: 400px;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
        }
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }
        button {
            background: #333;
            color: #00ff00;
            border: 1px solid #555;
            padding: 10px 20px;
            border-radius: 3px;
            cursor: pointer;
            margin: 0 10px;
        }
        button:hover {
            background: #555;
        }
        a {
            color: #00aaff;
            text-decoration: none;
            margin: 0 10px;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>8-bit ALU Test Suite</h1>
    
    <div class="controls">
        <button onclick="runALUTests()">K√∂r Tester</button>
        <button onclick="clearConsole()">Rensa Konsol</button>
        <a href="index.html">‚Üê Tillbaka till ALU</a>
    </div>
    
    <div id="console">Klicka p√• "K√∂r Tester" f√∂r att starta testerna...</div>

    <script src="alu.js"></script>
    <script>
        const consoleDiv = document.getElementById('console');
        
        // Override console.log to display in our div
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.join(' ');
            consoleDiv.textContent += message + '\n';
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            const message = args.join(' ');
            consoleDiv.textContent += message + '\n';
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        };
        
        function clearConsole() {
            consoleDiv.textContent = 'Konsol rensad.\n';
        }
        
        function runALUTests() {
            clearConsole();
            console.log('üß™ Starting 8-bit ALU Tests...\n');
            
            const alu = new ALU8Bit();
            let testsPassed = 0;
            let testsTotal = 0;
            
            function test(description, testFunction) {
                testsTotal++;
                try {
                    testFunction();
                    console.log(`‚úÖ ${description}`);
                    testsPassed++;
                } catch (error) {
                    console.error(`‚ùå ${description}: ${error.message}`);
                }
            }
            
            function assertEqual(actual, expected, message = '') {
                if (actual !== expected) {
                    throw new Error(`Expected ${expected}, got ${actual}. ${message}`);
                }
            }
            
            function assertFlags(actualFlags, expectedFlags, message = '') {
                for (const flag in expectedFlags) {
                    if (actualFlags[flag] !== expectedFlags[flag]) {
                        throw new Error(`Flag ${flag}: expected ${expectedFlags[flag]}, got ${actualFlags[flag]}. ${message}`);
                    }
                }
            }
            
            // Test logical operations
            console.log('üîß Testing Logical Operations:');
            
            test('AND operation: 42 & 15 = 10', () => {
                const result = alu.and(42, 15);
                assertEqual(result, 10);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('OR operation: 42 | 15 = 47', () => {
                const result = alu.or(42, 15);
                assertEqual(result, 47);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('XOR operation: 42 ^ 15 = 37', () => {
                const result = alu.xor(42, 15);
                assertEqual(result, 37);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('NOT operation: ~42 = 213', () => {
                const result = alu.not(42);
                assertEqual(result, 213);
                assertFlags(alu.getFlags(), { zero: false, negative: true, carry: false, overflow: false });
            });
            
            test('Zero flag test: 42 & 0 = 0', () => {
                const result = alu.and(42, 0);
                assertEqual(result, 0);
                assertFlags(alu.getFlags(), { zero: true, negative: false, carry: false, overflow: false });
            });
            
            // Test arithmetic operations
            console.log('\n‚ûï Testing Arithmetic Operations:');
            
            test('ADD operation: 100 + 50 = 150', () => {
                const result = alu.add(100, 50);
                assertEqual(result, 150);
                assertFlags(alu.getFlags(), { zero: false, negative: true, carry: false, overflow: true });
            });
            
            test('ADD with carry: 200 + 100 = 44 (with carry)', () => {
                const result = alu.add(200, 100);
                assertEqual(result, 44);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: true, overflow: false });
            });
            
            test('SUB operation: 100 - 30 = 70', () => {
                const result = alu.sub(100, 30);
                assertEqual(result, 70);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('SUB with underflow: 30 - 100 = 186', () => {
                const result = alu.sub(30, 100);
                assertEqual(result, 186);
                assertFlags(alu.getFlags(), { zero: false, negative: true, carry: true, overflow: false });
            });
            
            test('INC operation: 42 + 1 = 43', () => {
                const result = alu.inc(42);
                assertEqual(result, 43);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('INC overflow: 255 + 1 = 0 (with carry)', () => {
                const result = alu.inc(255);
                assertEqual(result, 0);
                assertFlags(alu.getFlags(), { zero: true, negative: false, carry: true, overflow: false });
            });
            
            test('DEC operation: 42 - 1 = 41', () => {
                const result = alu.dec(42);
                assertEqual(result, 41);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('DEC underflow: 0 - 1 = 255 (with carry)', () => {
                const result = alu.dec(0);
                assertEqual(result, 255);
                assertFlags(alu.getFlags(), { zero: false, negative: true, carry: true, overflow: false });
            });
            
            // Test shift operations
            console.log('\n‚¨ÖÔ∏è Testing Shift Operations:');
            
            test('SHL operation: 42 << 1 = 84', () => {
                const result = alu.shl(42);
                assertEqual(result, 84);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('SHL with carry: 200 << 1 = 144 (with carry)', () => {
                const result = alu.shl(200);
                assertEqual(result, 144);
                assertFlags(alu.getFlags(), { zero: false, negative: true, carry: true, overflow: false });
            });
            
            test('SHR operation: 42 >> 1 = 21', () => {
                const result = alu.shr(42);
                assertEqual(result, 21);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: false, overflow: false });
            });
            
            test('SHR with carry: 43 >> 1 = 21 (with carry)', () => {
                const result = alu.shr(43);
                assertEqual(result, 21);
                assertFlags(alu.getFlags(), { zero: false, negative: false, carry: true, overflow: false });
            });
            
            test('SHR to zero: 1 >> 1 = 0 (with carry)', () => {
                const result = alu.shr(1);
                assertEqual(result, 0);
                assertFlags(alu.getFlags(), { zero: true, negative: false, carry: true, overflow: false });
            });
            
            // Test edge cases
            console.log('\nüéØ Testing Edge Cases:');
            
            test('Maximum value operations: 255 & 255 = 255', () => {
                const result = alu.and(255, 255);
                assertEqual(result, 255);
                assertFlags(alu.getFlags(), { zero: false, negative: true, carry: false, overflow: false });
            });
            
            test('Zero operations: 0 | 0 = 0', () => {
                const result = alu.or(0, 0);
                assertEqual(result, 0);
                assertFlags(alu.getFlags(), { zero: true, negative: false, carry: false, overflow: false });
            });
            
            // Summary
            console.log(`\nüìä Test Results: ${testsPassed}/${testsTotal} tests passed`);
            
            if (testsPassed === testsTotal) {
                console.log('üéâ All tests passed! ALU implementation is working correctly.');
            } else {
                console.log('üö® Some tests failed. Please check the implementation.');
            }
        }
    </script>
</body>
</html>